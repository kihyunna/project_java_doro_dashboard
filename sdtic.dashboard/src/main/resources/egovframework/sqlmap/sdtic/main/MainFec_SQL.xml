<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="MainFec">
    <select id="MainFecDAO.getHdqrTextWithHdqrCd" parameterClass="String" resultClass="java.util.HashMap">  
		  SELECT hdqr_cd key,
		         hdqr_nm VALUE,
		         DECODE (hdqr_cd, #hdqr_cd#, 'selected', '') AS sel
		    FROM IOC_SDTIC_COMMON_DEPT
		GROUP BY hdqr_cd, hdqr_nm
		ORDER BY DECODE (HDQR_NM,
		                 '수도권본부', 1,
		                 '강원본부', 2,
		                 '충북본부', 3,
		                 '대전충남본부', 4,
		                 '전북본부', 5,
		                 '광주전남본부', 6,
		                 '대구경북본부', 7,
		                 '부산경남본부', 8,
		                 4)
    </select>  
    
    <select id="MainFecDAO.getMtnofTextWithHdqrCd" parameterClass="String" resultClass="java.util.HashMap">  
		  SELECT mtnof_cd key,
		         mtnof_nm VALUE,
		         DECODE (ROWNUM, 1, 'selected', '') AS sel,
		         hdqr_cd,
		         ROWNUM
		    FROM IOC_SDTIC_COMMON_DEPT
		   WHERE hdqr_cd = #hdqr_cd#
		ORDER BY mtnof_cd
    </select>
    
    <select id="MainFecDAO.getHdqrTextWithMtnofCd" parameterClass="String" resultClass="java.util.HashMap">  
		SELECT   hdqr_cd key,
		         hdqr_nm VALUE,
		         DECODE (a.hdqr_cd, b.key, b.sel, '') AS sel
		    FROM IOC_SDTIC_COMMON_DEPT a,
		         (SELECT hdqr_cd key, hdqr_nm VALUE, 'selected' AS sel
		            FROM IOC_SDTIC_COMMON_DEPT
		           WHERE mtnof_cd = #mtnof_cd#) b
		   WHERE a.hdqr_cd = b.key(+)
		GROUP BY hdqr_cd, hdqr_nm, DECODE (a.hdqr_cd, b.key, b.sel, '')
		ORDER BY DECODE (HDQR_NM,
		                 '수도권본부', 1,
		                 '강원본부', 2,
		                 '충북본부', 3,
		                 '대전충남본부', 4,
		                 '전북본부', 5,
		                 '광주전남본부', 6,
		                 '대구경북본부', 7,
		                 '부산경남본부', 8,
		                 4)
    </select> 
    
    <select id="MainFecDAO.getMtnofTextWithMtnofCd" parameterClass="String" resultClass="java.util.HashMap">  
		 
			  SELECT mtnof_cd key,
			         mtnof_nm value,
			         hdqr_cd,
			         DECODE (a.mtnof_cd, #mtnof_cd#, b.sel, '') AS sel
			    FROM IOC_SDTIC_COMMON_DEPT a,
			         (SELECT mtnof_cd key,
			                 mtnof_nm VALUE,
			                 'selected' AS sel,
			                 hdqr_cd hdqr
			            FROM IOC_SDTIC_COMMON_DEPT
			           WHERE mtnof_cd = #mtnof_cd#) b
			   WHERE a.hdqr_cd = b.hdqr
		ORDER BY mtnof_cd
    </select> 
    
    <select id="MainFecDAO.MainFecEventReportHdqr" resultClass="java.util.HashMap">  
		  SELECT hdqr_nm,
		         today_trobl,
		         today_recover,
		            TO_CHAR (
		               DECODE (HDQR_NM,
		                       '합계', ROUND ( (today_recover / today_trobl) * 100),
		                       today_diff))
		         || '%'
		            AS today_diff,
		         pre_trobl,
		         pre_recover,
		            TO_CHAR (
		               DECODE (HDQR_NM,
		                       '합계', ROUND ( (pre_recover / pre_trobl) * 100),
		                       pre_diff))
		         || '%'
		            AS pre_diff,
		         compare_trobl,
		         compare_recover
		    FROM (  SELECT DECODE (b.total_row, 1, '합계', a.HDQR_NM) HDQR_NM,
		                   SUM (a.today_trobl) AS today_trobl,
		                   SUM (a.today_recover) AS today_recover,
		                   SUM (a.today_diff) AS today_diff,
		                   SUM (a.pre_trobl) AS pre_trobl,
		                   SUM (a.pre_recover) AS pre_recover,
		                   SUM (a.pre_diff) AS pre_diff,
		                   SUM (a.compare_trobl) AS compare_trobl,
		                   SUM (a.compare_recover) AS compare_recover
		              FROM (  SELECT REPLACE (b.HDQR_NM, '본부', '') AS HDQR_NM,
		                             SUM (a.today_trobl) AS today_trobl,
		                             SUM (a.today_recover) today_recover,
		                             DECODE (
		                                SUM (a.today_trobl),
		                                0, 0,
		                                (ROUND (
		                                      SUM (a.today_recover)
		                                    / SUM (a.today_trobl)
		                                    * 100,
		                                    0)))
		                                AS today_diff,
		                             SUM (a.pre_trobl) pre_trobl,
		                             SUM (a.pre_recover) pre_recover,
		                             DECODE (
		                                SUM (a.pre_trobl),
		                                0, 0,
		                                (ROUND (
		                                    SUM (a.pre_recover) / SUM (a.pre_trobl) * 100,
		                                    0)))
		                                AS pre_diff,
		                             (SUM (a.today_trobl) - SUM (a.pre_trobl))
		                                AS compare_trobl,
		                             (SUM (a.today_recover) - SUM (a.pre_recover))
		                                AS compare_recover
		                        FROM (  SELECT fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM,
		                                       SUM (today_trobl) today_trobl,
		                                       SUM (today_recover) today_recover,
		                                       SUM (pre_trobl) pre_trobl,
		                                       SUM (pre_recover) pre_recover
		                                  FROM (  SELECT fac_type,
		                                                 1 AS fac_idx,
		                                                 MTNOF_CD,
		                                                 TO_CHAR (TUNL_CD) AS FAC_CD,
		                                                 TUNL_NM AS FAC_NM,
		                                                 SUM (today_trobl) today_trobl,
		                                                 SUM (today_recover) today_recover,
		                                                 SUM (pre_trobl) pre_trobl,
		                                                 SUM (pre_recover) pre_recover
		                                            FROM (SELECT '터널' AS fac_type,
		                                                         TUNL_CD,
		                                                         MTNOF_CD,
		                                                         TUNL_NM,
		                                                         CASE
		                                                            WHEN    (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 0)
		                                                                 OR (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER_TIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 2)
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_trobl,
		                                                         CASE
		                                                            WHEN     RECOVER_TIME =
		                                                                        TO_CHAR (
		                                                                           SYSDATE,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = 2
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_recover,
		                                                         CASE
		                                                            WHEN    (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 0)
		                                                                 OR (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER_TIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 2)
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_trobl,
		                                                         CASE
		                                                            WHEN     RECOVER_TIME =
		                                                                        TO_CHAR (
		                                                                           SYSDATE - 1,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = 2
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_recover
		                                                    FROM (  SELECT TUNL_CD,
		                                                                   MTNOF_CD,
		                                                                   TUNL_NM,
		                                                                   RECOVER,
		                                                                   TO_CHAR (EVENT_TIME,
		                                                                            'yyyymmdd')
		                                                                      AS EVENT_TIME,
		                                                                   TO_CHAR (RECOVER_TIME,
		                                                                            'yyyymmdd')
		                                                                      AS RECOVER_TIME,
		                                                                   COUNT (*) AS cnt
		                                                              FROM IOC_SDTIC_TUNNEL_EVENT
		                                                             WHERE     1 = 1
		                                                                   AND EVENT_LEVEL <![CDATA[ >= ]]>0
		                                                                   AND (   EVENT_TIME <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss')
		                                                                        OR RECOVER_TIME <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss'))
		                                                          GROUP BY TUNL_CD,
		                                                                   MTNOF_CD,
		                                                                   TUNL_NM,
		                                                                   MODL_NM,
		                                                                   RECOVER,
		                                                                   EVNT_NM,
		                                                                   TO_CHAR (EVENT_TIME,
		                                                                            'yyyymmdd'),
		                                                                   TO_CHAR (
		                                                                      RECOVER_TIME,
		                                                                      'yyyymmdd')) a)
		                                        GROUP BY fac_type,
		                                                 MTNOF_CD,
		                                                 TUNL_CD,
		                                                 TUNL_NM)
		                              GROUP BY fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM
		                              UNION ALL
		                                SELECT fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM,
		                                       SUM (today_trobl) today_trobl,
		                                       SUM (today_recover) today_recover,
		                                       SUM (pre_trobl) pre_trobl,
		                                       SUM (pre_recover) pre_recover
		                                  FROM (  SELECT fac_type,
		                                                 2 AS fac_idx,
		                                                 MTNOF_CD,
		                                                 TO_CHAR (RTU_LAMPINFO_SEQ) AS FAC_CD,
		                                                 ELRM_FCLTS_NM AS FAC_NM,
		                                                 SUM (today_trobl) today_trobl,
		                                                 SUM (today_recover) today_recover,
		                                                 SUM (pre_trobl) pre_trobl,
		                                                 SUM (pre_recover) pre_recover
		                                            FROM (SELECT '전기' AS fac_type,
		                                                         RTU_LAMPINFO_SEQ,
		                                                         MTNOF_CD,
		                                                         ELRM_FCLTS_NM,
		                                                         CASE
		                                                            WHEN    (    ALARMTIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 'N')
		                                                                 OR (    ALARMTIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND ALMLASTDATE =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 'Y')
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_trobl,
		                                                         CASE
		                                                            WHEN     ALMLASTDATE =
		                                                                        TO_CHAR (
		                                                                           SYSDATE,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = 'Y'
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_recover,
		                                                         CASE
		                                                            WHEN    (    ALARMTIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 'N')
		                                                                 OR (    ALARMTIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND ALMLASTDATE =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 'Y')
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_trobl,
		                                                         CASE
		                                                            WHEN     ALMLASTDATE =
		                                                                        TO_CHAR (
		                                                                           SYSDATE - 1,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = 'Y'
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_recover
		                                                    FROM (  SELECT RTU_LAMPINFO_SEQ,
		                                                                   MTNOF_CD,
		                                                                   ELRM_FCLTS_NM,
		                                                                   RETCODE AS recover,
		                                                                   TO_CHAR (ALARMTIME,
		                                                                            'yyyymmdd')
		                                                                      AS ALARMTIME,
		                                                                   TO_CHAR (ALMLASTDATE,
		                                                                            'yyyymmdd')
		                                                                      AS ALMLASTDATE,
		                                                                   COUNT (*) AS cnt
		                                                              FROM IOC_SDTIC_ELCTY_FCLTS_EVENT
		                                                             WHERE     1 = 1
		                                                                   AND (   ALARMTIME <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss')
		                                                                        OR ALMLASTDATE <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss'))
		                                                          GROUP BY RTU_LAMPINFO_SEQ,
		                                                                   MTNOF_CD,
		                                                                   RETCODE,
		                                                                   ELRM_FCLTS_NM,
		                                                                   ALARMTIME,
		                                                                   ALMLASTDATE) a)
		                                        GROUP BY fac_type,
		                                                 MTNOF_CD,
		                                                 RTU_LAMPINFO_SEQ,
		                                                 ELRM_FCLTS_NM)
		                              GROUP BY fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM
		                              UNION ALL
		                                SELECT fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM,
		                                       SUM (today_trobl) today_trobl,
		                                       SUM (today_recover) today_recover,
		                                       SUM (pre_trobl) pre_trobl,
		                                       SUM (pre_recover) pre_recover
		                                  FROM (  SELECT fac_type,
		                                                 4 AS fac_idx,
		                                                 MTNOF_CD,
		                                                 TO_CHAR (SVAR_CD) AS FAC_CD,
		                                                 SVAR_NM AS FAC_NM,
		                                                 SUM (today_trobl) today_trobl,
		                                                 SUM (today_recover) today_recover,
		                                                 SUM (pre_trobl) pre_trobl,
		                                                 SUM (pre_recover) pre_recover
		                                            FROM (SELECT '오수' AS fac_type,
		                                                         SVAR_CD,
		                                                         MTNOF_CD,
		                                                         SVAR_NM,
		                                                         CASE
		                                                            WHEN    (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 0)
		                                                                 OR (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER_TIME =
		                                                                            TO_CHAR (
		                                                                               SYSDATE,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 2)
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_trobl,
		                                                         CASE
		                                                            WHEN     RECOVER_TIME =
		                                                                        TO_CHAR (
		                                                                           SYSDATE,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = 2
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_recover,
		                                                         CASE
		                                                            WHEN    (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 0)
		                                                                 OR (    EVENT_TIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER_TIME =
		                                                                            TO_CHAR (
		                                                                                 SYSDATE
		                                                                               - 1,
		                                                                               'yyyymmdd')
		                                                                     AND RECOVER = 2)
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_trobl,
		                                                         CASE
		                                                            WHEN     RECOVER_TIME =
		                                                                        TO_CHAR (
		                                                                           SYSDATE - 1,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = 2
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_recover
		                                                    FROM (  SELECT SVAR_CD,
		                                                                   MTNOF_CD,
		                                                                   SVAR_NM,
		                                                                   re AS recover,
		                                                                   TO_CHAR (EVENT_TIME,
		                                                                            'yyyymmdd')
		                                                                      AS EVENT_TIME,
		                                                                   TO_CHAR (RECOVER_TIME,
		                                                                            'yyyymmdd')
		                                                                      AS RECOVER_TIME,
		                                                                   COUNT (*) AS cnt
		                                                              FROM IOC_SDTIC_PLTWTR_EVENT
		                                                             WHERE     1 = 1
		                                                                   AND (   EVENT_TIME <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss')
		                                                                        OR RECOVER_TIME <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss'))
		                                                          GROUP BY MTNOF_CD,
		                                                                   SVAR_CD,
		                                                                   SVAR_NM,
		                                                                   re,
		                                                                   TO_CHAR (EVENT_TIME,
		                                                                            'yyyymmdd'),
		                                                                   TO_CHAR (
		                                                                      RECOVER_TIME,
		                                                                      'yyyymmdd')) a)
		                                        GROUP BY fac_type,
		                                                 MTNOF_CD,
		                                                 SVAR_CD,
		                                                 SVAR_NM)
		                              GROUP BY fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM
		                              UNION ALL
		                                SELECT fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       TO_CHAR (FAC_CD),
		                                       FAC_NM,
		                                       SUM (today_trobl) today_trobl,
		                                       SUM (today_recover) today_recover,
		                                       SUM (pre_trobl) pre_trobl,
		                                       SUM (pre_recover) pre_recover
		                                  FROM (                           /*사면 조치없음*/
		                                        SELECT   fac_type,
		                                                 3 AS fac_idx,
		                                                 MSIS_GTWY_ID AS FAC_CD,
		                                                 MTNOF_CD,
		                                                 FAC_NM,
		                                                 SUM (today_trobl) today_trobl,
		                                                 0 AS today_recover,
		                                                 SUM (pre_trobl) pre_trobl,
		                                                 0 AS pre_recover
		                                            FROM (SELECT '사면' AS fac_type,
		                                                         a.MSIS_GTWY_ID,
		                                                         b.MTNOF_CD,
		                                                         b.FAC_NM,
		                                                         CASE
		                                                            WHEN     a.LSTTM_ALTR_DTTM =
		                                                                        TO_CHAR (
		                                                                           SYSDATE,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER <![CDATA[  <> ]]> '0'
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_trobl,
		                                                         CASE
		                                                            WHEN     a.LSTTM_ALTR_DTTM =
		                                                                        TO_CHAR (
		                                                                           SYSDATE,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = '0'
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            today_recover,
		                                                         CASE
		                                                            WHEN     a.LSTTM_ALTR_DTTM =
		                                                                        TO_CHAR (
		                                                                           SYSDATE - 1,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER <![CDATA[ <> ]]> '0'
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_trobl,
		                                                         CASE
		                                                            WHEN     a.LSTTM_ALTR_DTTM =
		                                                                        TO_CHAR (
		                                                                           SYSDATE - 1,
		                                                                           'yyyymmdd')
		                                                                 AND RECOVER = '0'
		                                                            THEN
		                                                               cnt
		                                                            ELSE
		                                                               0
		                                                         END
		                                                            pre_recover
		                                                    FROM (  SELECT MSIS_GTWY_ID,
		                                                                   MSIS_SNSR_ID,
		                                                                   MSIS_NTFC_KIND_CD,
		                                                                   USE_YN AS recover,
		                                                                   TO_CHAR (
		                                                                      FSTTM_RGST_DTTM,
		                                                                      'yyyymmdd')
		                                                                      AS FSTTM_RGST_DTTM,
		                                                                   TO_CHAR (
		                                                                      LSTTM_ALTR_DTTM,
		                                                                      'yyyymmdd')
		                                                                      AS LSTTM_ALTR_DTTM,
		                                                                   COUNT (MSIS_SNSR_ID)
		                                                                      AS cnt
		                                                              FROM IOC_SDTIC_SNSR_EVENT
		                                                             WHERE     1 = 1
		                                                                   AND (   FSTTM_RGST_DTTM <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss')
		                                                                        OR LSTTM_ALTR_DTTM <![CDATA[ >= ]]>
		                                                                              TO_DATE (
		                                                                                    TO_CHAR (
		                                                                                         SYSDATE
		                                                                                       - 1,
		                                                                                       'yyyymmdd')
		                                                                                 || '000000',
		                                                                                 'yyyymmddhh24miss'))
		                                                          GROUP BY MSIS_GTWY_ID,
		                                                                   MSIS_SNSR_ID,
		                                                                   MSIS_NTFC_KIND_CD,
		                                                                   USE_YN,
		                                                                   FSTTM_RGST_DTTM,
		                                                                   LSTTM_ALTR_DTTM) a,
		                                                         (SELECT MSIS_GTWY_ID,
		                                                                 MSIS_SNSR_ID,
		                                                                 MTNOF_CD,
		                                                                    USE_ROTNM
		                                                                 || ' '
		                                                                 || DRVE_DRNM
		                                                                 || '방향 '
		                                                                 || REGIN_NM
		                                                                    AS FAC_NM
		                                                            FROM IOC_SDTIC_SNSR_TOT_MHRLS) b
		                                                   WHERE     a.MSIS_GTWY_ID =
		                                                                b.MSIS_GTWY_ID
		                                                         AND a.MSIS_SNSR_ID =
		                                                                b.MSIS_SNSR_ID)
		                                        GROUP BY fac_type,
		                                                 MSIS_GTWY_ID,
		                                                 MTNOF_CD,
		                                                 FAC_NM)
		                              GROUP BY fac_type,
		                                       fac_idx,
		                                       MTNOF_CD,
		                                       FAC_CD,
		                                       FAC_NM) a,
		                             IOC_SDTIC_COMMON_DEPT b
		                       WHERE a.MTNOF_CD = b.MTNOF_CD
		                    GROUP BY REPLACE (b.HDQR_NM, '본부', '')) a,
		                   (SELECT 1 AS total_row FROM DUAL
		                    UNION ALL
		                    SELECT 2 AS total_row FROM DUAL) b
		          GROUP BY DECODE (b.total_row, 1, '합계', a.HDQR_NM))
		ORDER BY DECODE (HDQR_NM,
		                 '합계', 9,
		                 '수도권', 1,
		                 '강원', 2,
		                 '충북', 3,
		                 '대전충남', 4,
		                 '전북', 5,
		                 '광주전남', 6,
		                 '대구경북', 7,
		                 '부산경남', 8,
		                 4)
    </select> 
    
    <select id="MainFecDAO.MainFecEventReportMtnof" parameterClass="String" resultClass="java.util.HashMap">  
		 SELECT fac_type,
		         fac_idx,
		         fac_cd,
		         fac_nm,
		         SUM (a.today_trobl) AS today_trobl,
		         SUM (a.today_recover) today_recover,
		         DECODE (
		            SUM (a.today_trobl),
		            0, '-',
		               (ROUND (SUM (a.today_recover) / SUM (a.today_trobl) * 100, 0))
		            || '%')
		            AS today_diff,
		         SUM (a.pre_trobl) pre_trobl,
		         SUM (a.pre_recover) pre_recover,
		         DECODE (
		            SUM (a.pre_trobl),
		            0, '-',
		            (ROUND (SUM (a.pre_recover) / SUM (a.pre_trobl) * 100, 0)) || '%')
		            AS pre_diff,
		         (SUM (a.today_trobl) - SUM (a.pre_trobl)) AS compare_trobl,
		         (SUM (a.today_recover) - SUM (a.pre_recover)) AS compare_recover
		    FROM (  SELECT fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM,
		                   SUM (today_trobl) today_trobl,
		                   SUM (today_recover) today_recover,
		                   SUM (pre_trobl) pre_trobl,
		                   SUM (pre_recover) pre_recover
		              FROM (  SELECT fac_type,
		                             1 AS fac_idx,
		                             MTNOF_CD,
		                             TO_CHAR (TUNL_CD) AS FAC_CD,
		                             TUNL_NM AS FAC_NM,
		                             SUM (today_trobl) today_trobl,
		                             SUM (today_recover) today_recover,
		                             SUM (pre_trobl) pre_trobl,
		                             SUM (pre_recover) pre_recover
		                        FROM (SELECT '터널' AS fac_type,
		                                     TUNL_CD,
		                                     MTNOF_CD,
		                                     TUNL_NM,
		                                     CASE
		                                        WHEN    (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 0)
		                                             OR (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER_TIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 2)
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_trobl,
		                                     CASE
		                                        WHEN     RECOVER_TIME =
		                                                    TO_CHAR (SYSDATE, 'yyyymmdd')
		                                             AND RECOVER = 2
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_recover,
		                                     CASE
		                                        WHEN    (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 0)
		                                             OR (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER_TIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 2)
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_trobl,
		                                     CASE
		                                        WHEN     RECOVER_TIME =
		                                                    TO_CHAR (SYSDATE - 1,
		                                                             'yyyymmdd')
		                                             AND RECOVER = 2
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_recover
		                                FROM (  SELECT TUNL_CD,
		                                               MTNOF_CD,
		                                               TUNL_NM,
		                                               RECOVER,
		                                               TO_CHAR (EVENT_TIME, 'yyyymmdd')
		                                                  AS EVENT_TIME,
		                                               TO_CHAR (RECOVER_TIME, 'yyyymmdd')
		                                                  AS RECOVER_TIME,
		                                               COUNT (*) AS cnt
		                                          FROM IOC_SDTIC_TUNNEL_EVENT
		                                         WHERE     1 = 1
		                                               AND EVENT_LEVEL <![CDATA[ >= ]]> 0
		                                               AND (   EVENT_TIME <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss')
		                                                    OR RECOVER_TIME <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss'))
		                                      GROUP BY TUNL_CD,
		                                               MTNOF_CD,
		                                               TUNL_NM,
		                                               MODL_NM,
		                                               RECOVER,
		                                               EVNT_NM,
		                                               TO_CHAR (EVENT_TIME, 'yyyymmdd'),
		                                               TO_CHAR (RECOVER_TIME, 'yyyymmdd')) a)
		                    GROUP BY fac_type,
		                             MTNOF_CD,
		                             TUNL_CD,
		                             TUNL_NM)
		          GROUP BY fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM
		          UNION ALL
		            SELECT fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM,
		                   SUM (today_trobl) today_trobl,
		                   SUM (today_recover) today_recover,
		                   SUM (pre_trobl) pre_trobl,
		                   SUM (pre_recover) pre_recover
		              FROM (  SELECT fac_type,
		                             2 AS fac_idx,
		                             MTNOF_CD,
		                             TO_CHAR (RTU_LAMPINFO_SEQ) AS FAC_CD,
		                             ELRM_FCLTS_NM AS FAC_NM,
		                             SUM (today_trobl) today_trobl,
		                             SUM (today_recover) today_recover,
		                             SUM (pre_trobl) pre_trobl,
		                             SUM (pre_recover) pre_recover
		                        FROM (SELECT '전기' AS fac_type,
		                                     RTU_LAMPINFO_SEQ,
		                                     MTNOF_CD,
		                                     ELRM_FCLTS_NM,
		                                     CASE
		                                        WHEN    (    ALARMTIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 'N')
		                                             OR (    ALARMTIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND ALMLASTDATE =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 'Y')
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_trobl,
		                                     CASE
		                                        WHEN     ALMLASTDATE =
		                                                    TO_CHAR (SYSDATE, 'yyyymmdd')
		                                             AND RECOVER = 'Y'
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_recover,
		                                     CASE
		                                        WHEN    (    ALARMTIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 'N')
		                                             OR (    ALARMTIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND ALMLASTDATE =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 'Y')
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_trobl,
		                                     CASE
		                                        WHEN     ALMLASTDATE =
		                                                    TO_CHAR (SYSDATE - 1,
		                                                             'yyyymmdd')
		                                             AND RECOVER = 'Y'
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_recover
		                                FROM (  SELECT RTU_LAMPINFO_SEQ,
		                                               MTNOF_CD,
		                                               ELRM_FCLTS_NM,
		                                               RETCODE AS recover,
		                                               TO_CHAR (ALARMTIME, 'yyyymmdd')
		                                                  AS ALARMTIME,
		                                               TO_CHAR (ALMLASTDATE, 'yyyymmdd')
		                                                  AS ALMLASTDATE,
		                                               COUNT (*) AS cnt
		                                          FROM IOC_SDTIC_ELCTY_FCLTS_EVENT
		                                         WHERE     1 = 1
		                                               AND (   ALARMTIME <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss')
		                                                    OR ALMLASTDATE <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss'))
		                                      GROUP BY RTU_LAMPINFO_SEQ,
		                                               MTNOF_CD,
		                                               RETCODE,
		                                               ELRM_FCLTS_NM,
		                                               ALARMTIME,
		                                               ALMLASTDATE) a)
		                    GROUP BY fac_type,
		                             MTNOF_CD,
		                             RTU_LAMPINFO_SEQ,
		                             ELRM_FCLTS_NM)
		          GROUP BY fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM
		          UNION ALL
		            SELECT fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM,
		                   SUM (today_trobl) today_trobl,
		                   SUM (today_recover) today_recover,
		                   SUM (pre_trobl) pre_trobl,
		                   SUM (pre_recover) pre_recover
		              FROM (  SELECT fac_type,
		                             4 AS fac_idx,
		                             MTNOF_CD,
		                             TO_CHAR (SVAR_CD) AS FAC_CD,
		                             SVAR_NM AS FAC_NM,
		                             SUM (today_trobl) today_trobl,
		                             SUM (today_recover) today_recover,
		                             SUM (pre_trobl) pre_trobl,
		                             SUM (pre_recover) pre_recover
		                        FROM (SELECT '오수' AS fac_type,
		                                     SVAR_CD,
		                                     MTNOF_CD,
		                                     SVAR_NM,
		                                     CASE
		                                        WHEN    (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 0)
		                                             OR (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER_TIME =
		                                                        TO_CHAR (SYSDATE,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 2)
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_trobl,
		                                     CASE
		                                        WHEN     RECOVER_TIME =
		                                                    TO_CHAR (SYSDATE, 'yyyymmdd')
		                                             AND RECOVER = 2
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_recover,
		                                     CASE
		                                        WHEN    (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 0)
		                                             OR (    EVENT_TIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER_TIME =
		                                                        TO_CHAR (SYSDATE - 1,
		                                                                 'yyyymmdd')
		                                                 AND RECOVER = 2)
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_trobl,
		                                     CASE
		                                        WHEN     RECOVER_TIME =
		                                                    TO_CHAR (SYSDATE - 1,
		                                                             'yyyymmdd')
		                                             AND RECOVER = 2
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_recover
		                                FROM (  SELECT SVAR_CD,
		                                               MTNOF_CD,
		                                               SVAR_NM,
		                                               re AS recover,
		                                               TO_CHAR (EVENT_TIME, 'yyyymmdd')
		                                                  AS EVENT_TIME,
		                                               TO_CHAR (RECOVER_TIME, 'yyyymmdd')
		                                                  AS RECOVER_TIME,
		                                               COUNT (*) AS cnt
		                                          FROM IOC_SDTIC_PLTWTR_EVENT
		                                         WHERE     1 = 1
		                                               AND (   EVENT_TIME <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss')
		                                                    OR RECOVER_TIME <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss'))
		                                      GROUP BY MTNOF_CD,
		                                               SVAR_CD,
		                                               SVAR_NM,
		                                               re,
		                                               TO_CHAR (EVENT_TIME, 'yyyymmdd'),
		                                               TO_CHAR (RECOVER_TIME, 'yyyymmdd')) a)
		                    GROUP BY fac_type,
		                             MTNOF_CD,
		                             SVAR_CD,
		                             SVAR_NM)
		          GROUP BY fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM
		          UNION ALL
		            SELECT fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   TO_CHAR (FAC_CD),
		                   FAC_NM,
		                   SUM (today_trobl) today_trobl,
		                   SUM (today_recover) today_recover,
		                   SUM (pre_trobl) pre_trobl,
		                   SUM (pre_recover) pre_recover
		              FROM (  /*사면 조치없음*/
		                      SELECT fac_type,
		                             3 AS fac_idx,
		                             MSIS_GTWY_ID AS FAC_CD,
		                             MTNOF_CD,
		                             FAC_NM,
		                             SUM (today_trobl) today_trobl,
		                             0 AS today_recover,
		                             SUM (pre_trobl) pre_trobl,
		                             0 AS pre_recover
		                        FROM (SELECT '사면' AS fac_type,
		                                     a.MSIS_GTWY_ID,
		                                     b.MTNOF_CD,
		                                     b.FAC_NM,
		                                     CASE
		                                        WHEN     a.LSTTM_ALTR_DTTM =
		                                                    TO_CHAR (SYSDATE, 'yyyymmdd')
		                                             AND RECOVER <![CDATA[ <> ]]> '0'
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_trobl,
		                                     CASE
		                                        WHEN     a.LSTTM_ALTR_DTTM =
		                                                    TO_CHAR (SYSDATE, 'yyyymmdd')
		                                             AND RECOVER = '0'
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        today_recover,
		                                     CASE
		                                        WHEN     a.LSTTM_ALTR_DTTM =
		                                                    TO_CHAR (SYSDATE - 1,
		                                                             'yyyymmdd')
		                                             AND RECOVER <![CDATA[ <> ]]> '0'
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_trobl,
		                                     CASE
		                                        WHEN     a.LSTTM_ALTR_DTTM =
		                                                    TO_CHAR (SYSDATE - 1,
		                                                             'yyyymmdd')
		                                             AND RECOVER = '0'
		                                        THEN
		                                           cnt
		                                        ELSE
		                                           0
		                                     END
		                                        pre_recover
		                                FROM (  SELECT MSIS_GTWY_ID,
		                                               MSIS_SNSR_ID,
		                                               MSIS_NTFC_KIND_CD,
		                                               USE_YN AS recover,
		                                               TO_CHAR (FSTTM_RGST_DTTM, 'yyyymmdd')
		                                                  AS FSTTM_RGST_DTTM,
		                                               TO_CHAR (LSTTM_ALTR_DTTM, 'yyyymmdd')
		                                                  AS LSTTM_ALTR_DTTM,
		                                               COUNT (MSIS_SNSR_ID) AS cnt
		                                          FROM IOC_SDTIC_SNSR_EVENT
		                                         WHERE     1 = 1
		                                               AND (   FSTTM_RGST_DTTM <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss')
		                                                    OR LSTTM_ALTR_DTTM <![CDATA[ >= ]]>
		                                                          TO_DATE (
		                                                                TO_CHAR (SYSDATE - 1,
		                                                                         'yyyymmdd')
		                                                             || '000000',
		                                                             'yyyymmddhh24miss'))
		                                      GROUP BY MSIS_GTWY_ID,
		                                               MSIS_SNSR_ID,
		                                               MSIS_NTFC_KIND_CD,
		                                               USE_YN,
		                                               FSTTM_RGST_DTTM,
		                                               LSTTM_ALTR_DTTM) a,
		                                     (SELECT MSIS_GTWY_ID,
		                                             MSIS_SNSR_ID,
		                                             MTNOF_CD,
		                                                USE_ROTNM
		                                             || ' '
		                                             || DRVE_DRNM
		                                             || '방향 '
		                                             || REGIN_NM
		                                                AS FAC_NM
		                                        FROM IOC_SDTIC_SNSR_TOT_MHRLS) b
		                               WHERE     a.MSIS_GTWY_ID = b.MSIS_GTWY_ID
		                                     AND a.MSIS_SNSR_ID = b.MSIS_SNSR_ID)
		                    GROUP BY fac_type,
		                             MSIS_GTWY_ID,
		                             MTNOF_CD,
		                             FAC_NM)
		          GROUP BY fac_type,
		                   fac_idx,
		                   MTNOF_CD,
		                   FAC_CD,
		                   FAC_NM) a,
		         IOC_SDTIC_COMMON_DEPT b
		   WHERE a.MTNOF_CD = b.MTNOF_CD AND a.MTNOF_CD = #MTNOF_CD#
		GROUP BY fac_type,
		         fac_idx,
		         FAC_CD,
		         FAC_NM
		ORDER BY fac_idx, FAC_CD
    </select>
    
    <select id="MainFecDAO.MainFecEventReportMtnofDetail" parameterClass="String" resultClass="java.util.HashMap">  
		 SELECT '터널' AS kubun,
			       kubun_idx,
			       modl_nm || ' ' || evnt_nm content,
			       a.recover,
			       a.tunl_nm fclts_name,
			       TO_CHAR (a.event_time, 'yyyy-mm-dd hh24:mi:ss') event_time,
			       TO_CHAR (a.recover_time, 'yyyy-mm-dd hh24:mi:ss') recover_time
			  FROM (SELECT 1 AS kubun_idx,
			               INSR_SEQ,
			               TUNL_CD,
			               MTNOF_CD,
			               TUNL_NM,
			               MODL_NM,
			               DECODE (RECOVER, 0, '장애', '복구') AS RECOVER,
			               EVNT_NM,
			               EVENT_TIME,
			               recover_time
			          FROM IOC_SDTIC_TUNNEL_EVENT
			         WHERE     1 = 1
			               AND EVENT_LEVEL <![CDATA[ >= ]]> 0
			               AND (   EVENT_TIME <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss')
			                    OR recover_time <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss'))
			               AND MTNOF_CD = #MTNOF_CD#) a
			UNION ALL
			SELECT DECODE (
			          SYSGBN,
			          '1', DECODE (a.ELRM_STRLT_CLSS_CD,
			                       '1', '전기(터널)',
			                       '전기(영업소)'),
			          DECODE (a.ELRM_STRLT_CLSS_CD,
			                  'A', '전기(가로등)',
			                  '전기(조명탑)'))
			          AS kubun,
			       DECODE (SYSGBN,
			               '1', DECODE (a.ELRM_STRLT_CLSS_CD, '1', 2, 3),
			               DECODE (a.ELRM_STRLT_CLSS_CD, 'A', 4, 5))
			          AS kubun_idx,
			       content,
			       a.recover,
			       a.elrm_fclts_nm fclts_name,
			       TO_CHAR (a.event_time, 'yyyy-mm-dd hh24:mi:ss') event_time,
			       TO_CHAR (a.recover_time, 'yyyy-mm-dd hh24:mi:ss') recover_time
			  FROM (SELECT RTU_LAMPINFO_SEQ,
			               MTNOF_CD,
			               DECODE (RETCODE, 'N', '장애', '복구') AS recover,
			               CONTENT,
			               ELRM_STRLT_CLSS_CD,
			               ELRM_FCLTS_NM,
			               SYSGBN,
			               ALARMTIME AS event_time,
			               ALMLASTDATE AS recover_time
			          FROM IOC_SDTIC_ELCTY_FCLTS_EVENT
			         WHERE     1 = 1
			               AND (   ALARMTIME <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss')
			                    OR ALMLASTDATE <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss'))
			               AND MTNOF_CD = #MTNOF_CD#) a
			UNION ALL
			SELECT '오수' AS kubun,
			       kubun_idx,
			          a.dwrm_insr_nm
			       || ' '
			       || a.event_division_nm
			       || ' '
			       || a.pont_detl_istc
			          AS content,
			       a.recover,
			       a.svar_nm AS fclts_name,
			       TO_CHAR (a.event_time, 'yyyy-mm-dd hh24:mi:ss') AS event_time,
			       TO_CHAR (a.recover_time, 'yyyy-mm-dd hh24:mi:ss') recover_time
			  FROM (SELECT 6 AS kubun_idx,
			               MTNOF_CD,
			               SVAR_CD,
			               SVAR_NM,
			               EQUIP_CODE,
			               DEVICE_CODE,
			               EVENT_DIVISION,
			               EVENT_DIVISION_NM,
			               DWRM_INSR_NM,
			               PONT_DETL_ISTC,
			               DECODE (re, 0, '장애', '복구') AS RECOVER,
			               EVENT_TIME,
			               recover_time,
			                  SVAR_CD
			               || '_'
			               || EQUIP_CODE
			               || '_'
			               || DEVICE_CODE
			               || '_'
			               || PONT_DETL_ISTC
			                  AS uniq_code
			          FROM IOC_SDTIC_PLTWTR_EVENT
			         WHERE     1 = 1
			               AND MTNOF_CD = #MTNOF_CD#
			               AND (   EVENT_TIME <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss')
			                    OR recover_time <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss'))) a
			UNION ALL
			SELECT '사면' AS kubun,
			       kubun_idx,
			          a.MSIS_SNSR_ID
			       || '번 감지기에서 '
			       || DECODE (MSIS_NTFC_KIND_CD,
			                  '0', ' 비탈면 경고',
			                  '1', ' 비탈면 주의',
			                  ' 배터리 이상')
			          AS content,
			       a.recover,
			       b.fclts_name,
			       TO_CHAR (a.event_time, 'yyyy-mm-dd hh24:mi:ss') event_time,
			       TO_CHAR (a.recover_time, 'yyyy-mm-dd hh24:mi:ss') recover_time
			  FROM (SELECT 7 AS kubun_idx,
			               MSIS_GTWY_ID,
			               MSIS_SNSR_ID,
			               MSIS_NTFC_KIND_CD,
			               '이벤트발생' AS RECOVER,
			               FSTTM_RGST_DTTM AS event_time,
			               LSTTM_ALTR_DTTM AS recover_time
			          FROM IOC_SDTIC_SNSR_EVENT
			         WHERE     1 = 1
			               AND USE_YN <![CDATA[ <> ]]> '0'
			               AND (   FSTTM_RGST_DTTM  <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss')
			                    OR LSTTM_ALTR_DTTM  <![CDATA[ >= ]]>
			                          TO_DATE (TO_CHAR (SYSDATE, 'yyyymmdd') || '000000',
			                                   'yyyymmddhh24miss'))) a,
			       (SELECT MSIS_GTWY_ID,
			               MSIS_SNSR_ID,
			               HDQR_NM,
			               HDQR_CD,
			               MTNOF_NM,
			               MTNOF_CD,
			               GGTM_XCORD AS xcord,
			               GGTM_YCORD AS ycord,
			               '1' coord_type,
			                  USE_ROTNM
			               || ' '
			               || PBUS_STPNT_DSTNC
			               || 'km '
			               || DRVE_DRNM
			               || ' 방향'
			                  AS fclts_name
			          FROM IOC_SDTIC_SNSR_TOT_MHRLS) b
			 WHERE     a.MSIS_GTWY_ID = b.MSIS_GTWY_ID
			       AND a.MSIS_SNSR_ID = b.MSIS_SNSR_ID
			       AND b.MTNOF_CD = #MTNOF_CD#
			ORDER BY kubun_idx, kubun, event_time DESC
    </select>
    
    <select id="MainFecDAO.MainFecEventReportCctv" resultClass="java.util.HashMap">  
		  SELECT b.hdqr_nm,
		         b.mtnof_nm,
		         b.mtnof_cd,
		         GGTM_XCORD AS xcord,
		         GGTM_YCORD AS ycord,
		            a.SPIN_INTG_NM
		         || ' : 노선번호 '
		         || DECODE (SUBSTR (ROUTE_CD, 4, 1),
		                    '0', TO_NUMBER (ROUTE_CD) / 10,
		                    TO_NUMBER (ROUTE_CD))
		         || DECODE (ROUTE_DRCT_CD,
		                    'S', ' 상행 이정 ',
		                    'E', ' 하행 이정 ',
		                    ' 터널')
		         || DECODE (ROUTE_DRCT_CD, 'O', '', INSL_DSTNC)
		            fclts_name
		    FROM (SELECT *
		            FROM IOC_SDTIC_HIWAY_CCTV
		           WHERE cctvurl IS NULL) a,
		         IOC_SDTIC_COMMON_DEPT b
		   WHERE a.MTNOF_CD = b.MTNOF_CD
		ORDER BY DECODE (b.HDQR_NM,
		                 '수도권본부', 1,
		                 '강원본부', 2,
		                 '충북본부', 3,
		                 '대전충남본부', 4,
		                 '전북본부', 5,
		                 '광주전남본부', 6,
		                 '대구경북본부', 7,
		                 '부산경남본부', 8,
		                 4),
		         MTNOF_CD,
		         FCLTS_name
    </select>
   
    
</sqlMap>