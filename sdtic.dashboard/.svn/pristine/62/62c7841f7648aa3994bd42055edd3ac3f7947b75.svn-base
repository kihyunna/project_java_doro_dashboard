<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans  
                           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-2.5.xsd">
                           
<!--     <bean id="fecTotlInsrState" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrDAO"></bean> -->
<!-- 	<bean id="fecTotlInsrFcltState" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrFcltDAO"></bean> -->	
<!-- 	<bean id="fecTotlInsrErrorTS" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrDAO"></bean> -->
<!-- 	<bean id="fecTotlInsrFcltErrorTS" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrFcltDAO"></bean> -->
<!-- 	<bean id="fecTotlInsrErrorES" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrDAO"></bean> -->
<!-- 	<bean id="fecTotlInsrFcltErrorES" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrFcltDAO"></bean> -->
	
	<bean id="fecTotlInsrDAO" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrDAO"></bean>
	<bean id="fecTotlInsrFcltDAO" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrFcltDAO"></bean>
	<bean id="fecTotlInsrTotDAO" class="egovframework.com.sdtic.fecrs.service.impl.fecTotlInsrTotDAO"></bean>
	
    <!-- 하나.주기적으로 실행될 클래스 설정 -->
    <!-- property name은 jobClass로 fix, value는 사용자가 작성한 class 파일 위치 -->
    
<!--     하루에 한번 시설물 총 기기수 가져오기 -->
<!-- 1.8.6 org.springframework.scheduling.quartz.JobDetailBean -->
    <bean id="fecStateJob" class="org.springframework.scheduling.quartz.JobDetail">
        <property name="jobClass" value="egovframework.app.FecStateJob"/>
		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrFclt">
                	<ref local="fecTotlInsrFcltDAO"/>
                </entry>
                <entry key="fecTotlInsrTot">
                	<ref local="fecTotlInsrTotDAO"/>
                </entry>
			</map>
		</property>    	
    </bean>
<!--     터널, 사면 장애 가져오기 -->
    <bean id="fecErrorTSJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecErrorTSJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrFclt">
                	<ref local="fecTotlInsrFcltDAO"/>
                </entry>

			</map>
		</property>  
    </bean>
<!--     전기 오수 장애 가져오기 -->
    <bean id="fecErrorESJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecErrorESJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrFclt">
                	<ref local="fecTotlInsrFcltDAO"/>
                </entry>
                <entry key="fecTotlInsrTot">
                	<ref local="fecTotlInsrTotDAO"/>
                </entry>
			</map>
		</property>  
    </bean>
    <bean id="fecEventTunnelJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecEventTunnelJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrFclt">
                	<ref local="fecTotlInsrFcltDAO"/>
                </entry>

			</map>
		</property>  
    </bean>
    <bean id="fecEventElctsJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecEventElctsJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrFclt">
                	<ref local="fecTotlInsrFcltDAO"/>
                </entry>

			</map>
		</property>  
    </bean>
    <bean id="fecEventSvarJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecEventSvarJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrFclt">
                	<ref local="fecTotlInsrFcltDAO"/>
                </entry>

			</map>
		</property>  
    </bean>
    <bean id="fecEventSlopeJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecEventSlopeJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrTot">
                	<ref local="fecTotlInsrTotDAO"/>
                </entry>

			</map>
		</property>  
    </bean>
    <bean id="fecEventCctvJob" class="org.springframework.scheduling.quartz.JobDetailBean">
        <property name="jobClass" value="egovframework.app.FecEventCctvJob"/>
        		<property name="jobDataAsMap">
			<map>
				<entry key="fecTotlInsr">
                	<ref local="fecTotlInsrDAO"/>
                </entry>
                <entry key="fecTotlInsrTot">
                	<ref local="fecTotlInsrTotDAO"/>
                </entry>

			</map>
		</property>  
    </bean>    
 
    <!-- 둘.스케줄러의 interval time 설정 -->
    <!-- 쿼츠에는 아래와 같이 몇초에 한번씩 돌게 하는 Simple type 과 -->
    <!-- 무슨 요일 몇시에 한번씩 돌게 하는 날짜로 지정하는 Cron type 이 있다. -->
    <!-- 현재는 Simple type으로 세팅 -->
    <!-- jobDetail은 위에서 설정한 실제 동작할 클래스 id를 적어준다 -->
    <!-- startDelay는 서버 시작후 몇초 뒤에 시작할지 세팅(ms 단위)  -->
    <!-- repeatInterval은 몇 초에 한번씩 실행될 건지 세팅(ms 단위: 현재 1초) org.springframework.scheduling.quartz.CronTriggerBean -->
    <bean id="fecStateTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
        <property name="jobDetail" ref="fecStateJob"/>
        <property name="startDelay" value="25000"/>
<!--         <property name="repeatInterval" value="300000"/> -->
        <property name="cronExpression" value="0 0 03 * * ?"/>
<!--         <property name="cronExpression" value="0 0/1 * * * ?"/> -->
    </bean>
    <bean id="fecErrorTSTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecErrorTSJob"/>
        <property name="startDelay" value="25000"/>
        <property name="repeatInterval" value="300000"/>
    </bean>
    <bean id="fecErrorESTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecErrorESJob"/>
        <property name="startDelay" value="175000"/>
        <property name="repeatInterval" value="300000"/>
    </bean>
    <bean id="fecEventTunnelTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecEventTunnelJob"/>
        <property name="startDelay" value="30000"/>
        <property name="repeatInterval" value="5000"/>
    </bean>
    <bean id="fecEventElctsTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecEventElctsJob"/>
        <property name="startDelay" value="31000"/>
        <property name="repeatInterval" value="5000"/>
    </bean>
    <bean id="fecEventSvarTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecEventSvarJob"/>
        <property name="startDelay" value="32000"/>
        <property name="repeatInterval" value="5000"/>
    </bean>
    <bean id="fecEventSlopeTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecEventSlopeJob"/>
        <property name="startDelay" value="33000"/>
        <property name="repeatInterval" value="5000"/>
    </bean>
    <bean id="fecEventCctvTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
        <property name="jobDetail" ref="fecEventCctvJob"/>
        <property name="startDelay" value="40000"/>
        <property name="repeatInterval" value="3600000"/>
    </bean>
    <!--셋. 실제 동작하게끔 설정 -->
    <!--ref bean은 위에서 설정한 interval time 아이디를 넣어주면 됨  -->
    <bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <property name="triggers">
            <list>
<!--                 <ref bean="fecStateTrigger"/> -->
<!--                 <ref bean="fecErrorTSTrigger"/> -->
<!--                 <ref bean="fecErrorESTrigger"/> -->
<!--                 <ref bean="fecEventTunnelTrigger"/> -->
<!--                 <ref bean="fecEventElctsTrigger"/> -->
<!--                 <ref bean="fecEventSvarTrigger"/> -->
<!--                 <ref bean="fecEventSlopeTrigger"/> -->
<!--                 <ref bean="fecEventCctvTrigger"/> -->
            </list>
        </property>
        <!-- Quartz 실행시 세팅 -->
        <property name="quartzProperties">
            <props>
                <prop key="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</prop>
                <prop key="org.quartz.threadPool.threadCount">8</prop>
                <prop key="org.quartz.threadPool.threadPriority">8</prop>
                <prop key="org.quartz.jobStore.class">org.quartz.simpl.RAMJobStore</prop>
                <prop key="org.quartz.jobStore.misfireThreshold">60000</prop>
            </props>
        </property>
    </bean>
</beans>
