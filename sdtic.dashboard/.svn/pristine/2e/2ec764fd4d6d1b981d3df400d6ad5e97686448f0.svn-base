<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ifcWeb">

    <typeAlias  alias="egovMap"   type="egovframework.rte.psl.dataaccess.util.EgovMap"  />
    <typeAlias  alias="ifcWebVO"  type="egovframework.com.sdtic.ifcrs.service.IfcWebVO" />

    <select id="ifcWebDAO.ifcWebServerAjax" parameterClass="ifcWebVO" resultClass="ifcWebVO">
        /* ifcWebServerAjax 조회 */
        SELECT A.GUBUN,
               A.GROUP1,
               A.GROUP2,
               A.CRE_DATETIME,
               A.CPU,
		       A.MEMORY,
		       A.DISK,
               (SELECT CODE_NAME FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND CODE_LEVEL = 2 ) GROUP1_NAME,
		       (SELECT CODE_NAME FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND A.GROUP2 = GROUP2 ) GROUP2_NAME,
		       (SELECT CODE_ORDER FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND CODE_LEVEL = 2 ) GROUP1_ORDER,
		       (SELECT CODE_ORDER FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND A.GROUP2 = GROUP2 ) GROUP2_ORDER
          FROM (SELECT GUBUN,
                       GROUP1,
                       GROUP2,
                       CRE_DATETIME,
                       CPU,
		               MEMORY,
		               DISK
                  FROM IFC_SERVER_STATE) A,
               (  SELECT GUBUN,
                         GROUP1,
                         GROUP2,
                         MAX (CRE_DATETIME) MAX_CRE_DATETIME
                    FROM IFC_SERVER_STATE
                GROUP BY (GUBUN, GROUP1, GROUP2)) B
         WHERE A.GUBUN = B.GUBUN
           AND A.GROUP1 = B.GROUP1
           AND A.GROUP2 = B.GROUP2
           AND A.CRE_DATETIME = B.MAX_CRE_DATETIME
       <isNotEmpty property="gubun">
           <![CDATA[
           AND A.GUBUN = #gubun#
           ]]>
       </isNotEmpty>
       <isNotEmpty property="group1">
           <![CDATA[
           AND A.GROUP1 = #group1#
           ]]>
       </isNotEmpty>
       <isNotEmpty property="group2">
           <![CDATA[
           AND A.GROUP2 = #group2#
           ]]>
       </isNotEmpty>
         ORDER BY GROUP1_ORDER, GROUP2_ORDER
    </select>

    <select id="ifcWebDAO.ifcWebPrfomncAjax" parameterClass="ifcWebVO" resultClass="ifcWebVO">
        /* ifcWebPrfomncAjax 조회 */
        SELECT A.GUBUN,
               A.GROUP1,
               A.GROUP2,
               A.GROUP3,
               A.CRE_DATETIME,
               A.HH_00,
               A.HH_01,
               A.HH_02,
               A.HH_03,
               A.HH_04,
               A.HH_05,
               A.HH_06,
               A.HH_07,
               A.HH_08,
               A.HH_09,
               A.HH_10,
               A.HH_11,
               A.HH_12,
               A.HH_13,
               A.HH_14,
               A.HH_15,
               A.HH_16,
               A.HH_17,
               A.HH_18,
               A.HH_19,
               A.HH_20,
               A.HH_21,
               A.HH_22,
               A.HH_23,
               A.HH_24,
               (SELECT CODE_NAME FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND CODE_LEVEL = 2 ) GROUP1_NAME,
               (SELECT CODE_NAME FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND A.GROUP2 = GROUP2 ) GROUP2_NAME,
               (SELECT CODE_ORDER FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND CODE_LEVEL = 2 ) GROUP1_ORDER,
               (SELECT CODE_ORDER FROM IFC_CODE WHERE A.GUBUN = GUBUN AND A.GROUP1 = GROUP1 AND A.GROUP2 = GROUP2 ) GROUP2_ORDER,
               (SELECT CODE_NAME FROM IFC_CODE WHERE GUBUN = 'CD' AND GROUP1 = 'PRF' AND GROUP2 = A.GROUP3 ) GROUP3_NAME,
               (SELECT CODE_ORDER FROM IFC_CODE WHERE GUBUN = 'CD' AND GROUP1 = 'PRF' AND GROUP2 = A.GROUP3 ) GROUP3_ORDER
          FROM (SELECT GUBUN,
                       GROUP1,
                       GROUP2,
                       GROUP3,
                       CRE_DATETIME,
                       HH_00,
		               HH_01,
		               HH_02,
		               HH_03,
		               HH_04,
		               HH_05,
		               HH_06,
		               HH_07,
		               HH_08,
		               HH_09,
		               HH_10,
		               HH_11,
		               HH_12,
		               HH_13,
		               HH_14,
		               HH_15,
		               HH_16,
		               HH_17,
		               HH_18,
		               HH_19,
		               HH_20,
		               HH_21,
		               HH_22,
		               HH_23,
		               HH_24
                  FROM IFC_WEB_PRFOMNC_STATE) A,
               (  SELECT GUBUN,
                         GROUP1,
                         GROUP2,
                         GROUP3,
                         MAX (CRE_DATETIME) MAX_CRE_DATETIME
                    FROM IFC_WEB_PRFOMNC_STATE
                GROUP BY (GUBUN, GROUP1, GROUP2, GROUP3)) B
         WHERE A.GUBUN = B.GUBUN
           AND A.GROUP1 = B.GROUP1
           AND A.GROUP2 = B.GROUP2
           AND A.GROUP3 = B.GROUP3
           AND A.CRE_DATETIME = B.MAX_CRE_DATETIME
       <isNotEmpty property="gubun">
           <![CDATA[
           AND A.GUBUN = #gubun#
           ]]>
       </isNotEmpty>
       <isNotEmpty property="group1">
           <![CDATA[
           AND A.GROUP1 = #group1#
           ]]>
       </isNotEmpty>
       <isNotEmpty property="group2">
           <![CDATA[
           AND A.GROUP2 = #group2#
           ]]>
       </isNotEmpty>
         ORDER BY GROUP1_ORDER, GROUP2_ORDER, GROUP3_ORDER
    </select>

</sqlMap>