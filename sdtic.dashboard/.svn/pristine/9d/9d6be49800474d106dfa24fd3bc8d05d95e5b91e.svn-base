<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c"       uri="http://java.sun.com/jsp/jstl/core"                     %>

<!DOCTYPE html>
<html lang="ko">
<head>
<title></title>
<meta charset="utf-8">
<title>비즈니스 설계도서 34종 입력률</title>
<!-- including ECharts file -->
<c:set var="contextPath" value="${pageContext.request.contextPath}" />

<script type="text/javascript" src="${contextPath}/js/echarts/dist/echarts.min.js"></script>
<script type="text/javascript" src="${contextPath}/js/echarts/etc/echarts-gl.min.js"></script>

<script type="text/javascript" src="${contextPath}/js/common/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="${contextPath}/js/echarts/dist/world.js"></script>
<script type="text/javascript" src="${contextPath}/js/echarts/theme/dark.js"></script>
</head>

<body style="background-color:#000;">

     <div id="main_buc_fclts" style="width:500px;height:280px; " ></div>
    
    <script type="text/javascript">
       var buc_fclts_chart = echarts.init(document.getElementById('main_buc_fclts'));
   
   
       var hours = ['', '', '','', '', '', ''];
       var days = ['', '', '', '', ''];
   
       //var timeLineData = ['1', '2', '3', '4', '5', '6', '7', '8']
   
       var data = [ 
           [0, 0, 0,'중앙\n분리대'],
           [1, 0, 0,'차량방호\n안전시설'],
           [2, 0, 0,'시선유도\n표지'],
           [3, 0, 0,'갈매기\n표지'],
           [4, 0, 0,'도로표지병'],
           [5, 0, 0,'시선유도봉'],
           [6, 0, 0,'충격흡수시설'],
           [0, 1, 0,'정차대'],
           [1, 1, 0,'방음벽'],
           [2, 1, 0,'제설시설'],
           [3, 1, 0,'종단경사'],
           [4, 1, 0,'평면선형'],
           [5, 1, 0,'도로중심선'],
           [6, 1, 0,'측구'],
           [0, 2, 0,'배수관'],
           [1, 2, 0,'석축'],
           [2, 2, 0,'출입시설'],
           [3, 2, 0,'과속카메라'],
           [4, 2, 0,'암거'],
           [5, 2, 0,'터널'],
           [6, 2, 0,'절토사면'],
           [0, 3, 0,'교량'],
           [1, 3, 0,'차선도색'],
           [2, 3, 0,'그루빙'],
           [3, 3, 0,'오르막차로'],
           [4, 3, 0,'휴게소'],
           [5, 3, 0,'본선\n길어깨'],
           [6, 3, 0,'영업소'],
           [0, 4, 0,'공구\n일반현황'],
           [1, 4, 0,'포장\일반현황'],
           [2, 4, 0,'비점오염\n저감시설'],
           [3, 4, 0,'포장시공\n이력'],
           [4, 4, 0,'오르막\n차로'],
           [5, 4, 0,'표지판']
       ];
   		
       	var title = new Array();
       	var rate = new Array();
         
        jQuery(document).ready(function($){
    		
        	//-----------------------------------AJAX 호출 영역 ---------------------------------------

        	       getBucFcltsDataTransferdbAjax();

        	//-----------------------------------AJAX 호출 영역 ---------------------------------------
        })
        function getBucFcltsDataTransferdbAjax(){
        $.ajax({
            url : "${pageContext.request.contextPath}/buc/bucFcltsDataTransferdbAjax.do",
            async : false,
            dataType : 'json',
            success :function(json) {           

                    if(json.data.length > 0 ){
                        for(var i = 0; i < json.data.length; i++) {
                        	data[i][2]= json.data[i].rate;
                        	data[i][3] = json.data[i].title;
                        	if(data[i][3].length >= 6){
                        		data[i][3] = json.data[i].title.substring(0,4) + '\r\n' + json.data[i].title.substring(4,json.data[i].title.length);
                        	}
                        }
                    }
                    else{
                    console.log(arguments);
                    }
    
                },error : function(){
                    console.log(arguments);
                }, complete : function() {
                	buc_fclts_chart.setOption(option);
                }
            });
        
        }
	
   
       option = {
                   trigger: 'item',
                  
                   axisPointer: {
                       show: false,
                       type: 'shadow' //shadow  cross line
                   },
                   backgroundColor: '#ffffffff',
                   borderWidth: 1,
                   borderColor: '#ccc',
                   padding: 10,
                   textStyle: {
                       color: '#fff'
                   },
               animation: true,
               grid: {
                   //height: '50%',
                   y: '27',
                   y2: '20',
                   x: '10',
                   x2: '10',
               },
               xAxis: {
                   type: 'category',
                   data: hours,
                   position: 'top',
                   splitArea: {
                       show: true
                   },
                   axisTick:{
                       inside:true
                   }
               },
               yAxis: {
                   inverse: true,
                   type: 'category',
                   data: days,
                   splitArea: {
                       show: true
                   },
                   axisTick:{
                       inside:true
                   }
               },
               legend: {
                   orient: 'vertical',
                   x:'right',
                   data:['경고','주의','정상'],
                   textStyle: {
                       color: "#000"
                   }
               },
               visualMap: {
                   type: 'piecewise',
                   splitNumber: 2,

                    textStyle: {
                        color: "#fff"
                    },
                   pieces: [
                       {
                           gt: 0,
                           lte: 35,
                           color:'rgba(255,51,51,0.7)',
                           
                           //symbol:'pin',
                           //symbolSize:'10'
                           
                           //opacity:100
                           //colorAlpha:10
                       },
                       {
                           gt: 35,
                           lte: 70,
                           color:'rgba(131,151,0,0.7)',
                           //symbol:'pin',
                           //symbolSize:'10'
                           
                           //opacity:100
                           //colorAlpha:10
                       },
                       
                      {
                           gt: 70,
                           lte: 100,
                           //color:'rgba(204,204,153,0.4)',
                           color:'rgba(9,128,73,0.7)',
                           //opacity:100
                           //colorAlpha:0.5
                       }
                   ],
                  
                   dimension: 2,
                   //min: 0,
                  // max: 100,
                   //itemWidth: '20',
                   itemHeight: '20',
                   align: 'left',
                   show: true,
                   //calculable: true,
                   orient: 'horizontal', //'vertical'  horizontal
                   left: 'right', //center   
                   top: 'top',
                   bottom: '15%'
               },
               series: [{
                   name: 'channel',
                   type: 'heatmap',
                   data: data,
                   label: {
                       normal: {
                           show: true, //是否显示叉叉
                           formatter: function(v) {
                               //alert(v.value[3]);
                               //显示节目名称
                               return v.value[3]+'\n'+ v.value[2] ;
   
                           }
                       }
                   },
                   itemStyle: {
                       emphasis: {
                           shadowBlur: 10,
                           shadowColor: 'rgba(0, 0, 0, 0.5)'
                       }
                   }
               }]
           
       };
    /*    function buc_fclts_getData(currentIndex){
           
           data = data.map(function(item) {
               //alert(item[3]);
               return [item[0], item[1], Math.round(Math.random() * 70+30) || '-', item[3]];
           });
           //option1.baseOption.timeline.currentIndex = currentIndex;
           option1.series.data = data;
           
           buc_fclts_chart.setOption({
               series:{
                   data: data
               }
           });
       }
       
       buc_fclts_chart.on('timelinechanged', function (params) {
          buc_fclts_getData(params.currentIndex);
       });
   
       buc_fclts_chart.setOption(option1); */
       
       $(window).load(function() {
			setDivHeight('main_buc_fclts');
		});
		
	    $(window).resize(function(){

	        setDivHeight('main_buc_fclts');

	    });

	    function setDivHeight(objSet)
	    {

	        var objSet   = document.getElementById(objSet);
	        objSet.style.width  = ($(window).width()) + "px";
	        objSet.style.height  = ($(window).height()) + "px";


	        $('#main_buc_fclts').width(($(window).width()) + "px");
	        $('#main_buc_fclts').height(($(window).height()) + "px");


	        buc_fclts_chart.resize({
	            width: $(window).width(),
	            height : $(window).height()
	            
	        });
	        buc_fclts_chart.setOption(option);
			
	    }
       </script>
</body>
</html>